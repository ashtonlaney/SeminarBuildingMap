@page "{id}"
@model SeminarBuildingMap.Areas.Admin.Pages.EditAvailabilityModel
@{
}


<a asp-page="OwnedRoomSearch/" class="btn btn-dark btn-default pull-right text-light font-weight-bolder shadow">Return to search</a>
<br /><br />

<h1 class="text-dark font-weight-bolder">Edit Room</h1>
<div asp-validation-summary="All" class="text-danger"></div>
<ul class="nav nav-tabs" role="tablist">
    <li class="nav-item"><a class="nav-link font-weight-bolder" role="tab" aria-controls="home" aria-selected="false" asp-page="OwnedRoomDisplay/" asp-route-id="@RouteData.Values["id"]">View/Edit Room</a></li>
    <li class="nav-item shadow"><a class="nav-link active font-weight-bolder" role="tab" aria-controls="home" aria-selected="true">View/Edit Availability</a></li>
    <li class="nav-item"><a class="nav-link font-weight-bolder" role="tab" aria-controls="home" aria-selected="false" asp-page="EditEvent/" asp-route-id="@RouteData.Values["id"]">View/Edit Events</a></li>
    <li class="nav-item"><a class="nav-link font-weight-bolder" role="tab" aria-controls="home" aria-selected="false" asp-page="EditOwners/" asp-route-id="@RouteData.Values["id"]">View/Edit Assigned Persons</a></li>
</ul>
<br />
<div class="tab-content">
    <div class="tab-pane fade show active">
        <form method="post">
            @(Html
                .Grid(Model.lclSchedule)
                .Build(columns =>
                {
                    columns.Add(model => model.avId).Titled("id").Css("hiddenColumn");
                    columns.Add(model => model.avName).Titled("Name");
                    columns.Add(model => model.avDay).Titled("Day").Filterable(GridFilterType.Multi).UsingFilterOptions(new[]
                    {
                        new SelectListItem {Value = "Monday", Text = "Monday" },
                        new SelectListItem {Value = "Tuesday", Text = "Tuesday"},
                        new SelectListItem {Value = "Wednesday", Text = "Wednesday"},
                        new SelectListItem {Value = "Thursday", Text = "Thursday" },
                        new SelectListItem {Value = "Friday", Text = "Friday" },
                        new SelectListItem {Value = "Saturday", Text = "Saturday" },
                        new SelectListItem {Value = "Sunday", Text = "Sunday" }
                        });

                    columns.Add(model => model.StartTime.ToShortTimeString()).Titled("Start Time").Named("av-start-time");
                    columns.Add(model => model.EndTime.ToShortTimeString()).Titled("End Time").Named("av-end-time");
                    columns.Add(model => model.StartTime.ToString("HH:mm")).Titled("24hrStart").Named("24-hr-start").Css("hiddenColumn");
                    columns.Add(model => model.EndTime.ToString("HH:mm")).Titled("24hrEnd").Named("24-hr-end").Css("hiddenColumn");
                })
                .Empty("No Scheduled Availability")
                .Sortable()
                .Pageable()
                .Filterable()
            )


            <div class="form-group">
                <input id="id" type="hidden" asp-for="lclNewAvailability.avId" value="0" />
                <div class="form-group">
                    <label class="text-dark font-weight-bold" style="padding-top:15px">Name</label>
                    <input class="form-control shadow" id="name" asp-for="lclNewAvailability.avName" required />
                    <span asp-validation-for="lclNewAvailability.avName" class="text-danger"></span>
                </div>
                <div class="form-group" id="checkboxes">
                    <label class="text-dark font-weight-bold">Day(s):</label>
                    <br />
                    <label class="form-check-label text-dark font-weight-bold"><input class="form-check-inline" type="checkbox" value="Monday" name="checkboxDays" />Monday</label>
                    <br />
                    <label class="form-check-label text-dark font-weight-bold"><input class="form-check-inline" type="checkbox" value="Tuesday" name="checkboxDays" />Tuesday</label>
                    <br />
                    <label class="form-check-label text-dark font-weight-bold"><input class="form-check-inline" type="checkbox" value="Wednesday" name="checkboxDays" />Wednesday</label>
                    <br />
                    <label class="form-check-label text-dark font-weight-bold"><input class="form-check-inline" type="checkbox" value="Thursday" name="checkboxDays" />Thursday</label>
                    <br />
                    <label class="form-check-label text-dark font-weight-bold"><input class="form-check-inline" type="checkbox" value="Friday" name="checkboxDays" />Friday</label>
                    <br />
                    <label class="form-check-label text-dark font-weight-bold"><input class="form-check-inline" type="checkbox" value="Saturday" name="checkboxDays" />Saturday</label>
                    <br />
                    <label class="form-check-label text-dark font-weight-bold"><input class="form-check-inline" type="checkbox" value="Sunday" name="checkboxDays" />Sunday</label>
                </div>
                <div class="form-group" id="divDayDisplay" style="display:none;">
                    <label class="text-dark font-weight-bold">Day:</label>
                    <input class="form-control shadow" id="dayDisplay" readonly />
                </div>
                <div class="form-group">
                    <label class="text-dark font-weight-bold">Start Time</label>
                    <input class="form-control shadow" id="start" asp-for="lclNewAvailability.avStartTime" required type="time" />
                    <span asp-validation-for="lclNewAvailability.avStartTime" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label class="text-dark font-weight-bold">End Time</label>
                    <input class="form-control shadow" id="end" asp-for="lclNewAvailability.avEndTime" required type="time" />
                    <span asp-validation-for="lclNewAvailability.avEndTime" class="text-danger"></span>
                </div>
            </div>

            <button onclick="cancelEdit()" id="cancel" style="display:none;" class="btn btn-dark text-light font-weight-bolder shadow">Cancel Edit</button>
            <button type="submit" id="delete" style="display:none;" asp-page-handler="delete" class="btn btn-danger text-light font-weight-bolder shadow">Delete Selected</button>
            <button type="submit" id="submit" class="btn btn-dark text-light font-weight-bolder shadow" asp-page-handler="save">Add</button>
        </form>
    </div>
</div>
@section Scripts
{
    <script src="~/js/mvc-grid/mvc-grid.js"></script>
    <script>
        [].forEach.call(document.getElementsByClassName('mvc-grid'), function (element) {
            new MvcGrid(element);
        });
    </script>
    <script>
        document.addEventListener('rowclick', function (e) {
            document.getElementById("id").value = e.detail.data["av-id"];
            document.getElementById("name").value = e.detail.data["av-name"];
            document.getElementById("start").value = e.detail.data["24-hr-start"];
            document.getElementById("end").value = e.detail.data["24-hr-end"];
            document.getElementById("dayDisplay").value = e.detail.data["av-day"];
            $("#delete").show();
            $("#cancel").show();
            $("#checkboxes").hide();
            $("#divDayDisplay").show();
            document.getElementById("submit").textContent = "Update";
        });
    </script>


    <script>
        function cancelEdit() {
            document.getElementById("id").value = "0";
            document.getElementById("name").value = "";
            document.getElementById("start").value = "";
            document.getElementById("end").value = "";
            $("#delete").hide();
            $("#cancel").hide();
            $("#checkboxes").show();
            $("#divDayDisplay").hide();
            document.getElementById("submit").textContent = "Add New";
        }
    </script>

    <partial name="_ValidationScriptsPartial" />
}
